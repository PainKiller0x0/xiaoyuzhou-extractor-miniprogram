<view class="container" style="padding-bottom: {{containerPaddingBottom}}rpx;">

<view class="header">
  <image class="logo" src="/images/logo.png" mode="aspectFit"></image>
  <view class="title-wrapper">
    <text class="main-title">收录宇宙絮语</text>
    <text class="sub-title">点亮文字星河</text>
    <text class="description-text">一键提取小宇宙播客音频，让知识随身听。</text>
  </view>
</view>

<view class="content-area">

  <block wx:if="{{!resultUrl}}">
    <view class="input-section-card content-card-base">
      <textarea
        class="url-input"
        placeholder="请在此处粘贴小宇宙播客单集链接..."
        model:value="{{inputValue}}"
        bindinput="onInput"
        auto-height
        maxlength="-1"
        placeholder-class="input-placeholder"
      ></textarea>
      <button class="paste-link-button {{showPasteButton ? 'paste-link-button--visible' : 'paste-link-button--hidden'}}" 
              bind:tap="onPasteLinkTap"></button>
    </view>
    
    <view class="status-message-box" wx:if="{{statusMessage || errorType}}">
        <block wx:if="{{errorType}}">
            <text class="status-message-icon">⚠️</text>
            <text class="status-message-text status-error-text">{{statusMessage}}</text>
            <button class="retry-button" 
                    wx:if="{{errorType === 'PARSE_FAILED' || errorType === 'NETWORK_ERROR'}}" 
                    bind:tap="onRetryTap">重试</button>
            <button class="feedback-button"
                    wx:if="{{errorType === 'PARSE_FAILED' || errorType === 'NETWORK_ERROR'}}"
                    bind:tap="onFeedbackTap">反馈问题</button>
            
            <button class="reset-from-error-button" 
                    bind:tap="onResetTap">重新开始</button>
        </block>
        <block wx:elif="{{statusMessage}}">
            <text class="status-message-icon">💡</text>
            <text class="status-message-text">{{statusMessage}}</text>
        </block>
    </view>
  </block>

  <block wx:else>
    <view class="result-section-card content-card-base">
      <view class="result-header">
        <text class="result-icon">🔗</text>
        <text class="result-title">音频直链已生成</text>
      </view>
      <text class="podcast-title">{{podcastTitle}}</text> <text class="result-url clickable-url" user-select bind:tap="onCopyLinkOnly">{{resultUrl}}</text>
      <text class="copy-hint-text">点击链接即可复制</text>
    </view>
  </block>
  
</view>

<view class="bottom-actions-fixed" style="padding-bottom: {{safeAreaBottom + 40}}rpx;"> 
  <block wx:if="{{!errorType}}">
    <button class="action-button {{resultUrl ? 'copy-button' : 'extract-button'}}" bind:tap="{{resultUrl ? 'onCopyAndNavigateTap' : 'onExtractTap'}}" loading="{{isLoading}}" disabled="{{isLoading}}">
      <text wx:if="{{isLoading}}">✨ 正在提取...</text>
      <text wx:elif="{{resultUrl}}">📋 复制 • 转写</text>
      <text wx:else>✨ 提取音频</text>
    </button>
  </block>

  <view class="secondary-action-area" wx:if="{{resultUrl}}">
    <button class="secondary-button" bind:tap="onResetTap">提取新链接</button>
  </view>
</view>

</view>